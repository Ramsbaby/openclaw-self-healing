# 2026-01-30 (목)

## 세션 크기 모니터링 시스템 구축 ✅

**크론 설정**
- 이름: "세션 크기 모니터링"
- 주기: 10분마다 (`*/10 * * * *`)
- 스크립트: `~/clawd/scripts/monitor.sh`

**단계별 알림**
- 0-40%: 알림 없음
- 40-60% 🟢: 적정 (1시간에 1번)
- 60-80% 🟡: 주의 + /compact 버튼
- 80-95% 🟠: 위험 + 버튼
- 95%+ 🔴: 긴급 + 버튼
- 에러 시: 실패 알림

**수정한 이슈 (정우님 피드백)**
1. ClawdHub 업데이트 영향 → `~/clawd/scripts/`로 분리
2. PATH 하드코딩 → 동적 nvm 감지
3. 상태 파일 원자성 → 임시파일 + mv
4. 에러 알림 추가

**관련 파일**
- `~/clawd/scripts/monitor.sh` — 모니터링 스크립트
- `~/clawd/scripts/.monitor-state.json` — 상태 파일
- 크론 ID: `f5ec552c-0990-4abe-98e6-e52fc5f445d3`

---

## Clawdbot → Moltbot 리브랜딩

- 1월 27일 Anthropic 상표권 요청으로 이름 변경
- ClawdHub는 아직 유지 (MoltHub로 바뀔 수도)
- 현재 시스템은 `clawdbot` 명령어 사용 중

---

## ClawdHub 스킬 검토

**추천 스킬 (미설치)**
- github — gh CLI 통합
- tailscale — Tailnet 관리
- youtube-summarizer — YouTube 요약
- prompt-log — AI 세션 로그 추출
- news-aggregator — 뉴스 통합 (HN, GitHub Trending 등)

**현재 설치됨 (22개)**
auto-updater, clawddocs, coding-agent, context-manager, conventional-commits, deepwork-tracker, dexter, gemini, model-usage, mole-mac-cleanup, obsidian, portfolio-watcher, process-watch, research, self-improvement, session-logs, simple-backup, smart-followups, stock-analysis, summarize, task-tracker, yahoo-finance

---

## 스킬 설치 (5개) ✅

**설치 완료**
- github — gh CLI 통합 (Ramsbaby 로그인됨)
- youtube-summarizer — MCP 서버 설치 (`~/clawd/mcp-server-youtube-transcript`)
- prompt-log — 세션 로그 추출
- arxiv-watcher — ArXiv 논문 검색
- news-aggregator-skill — 뉴스 수집 (HN, GitHub Trending 등)

**크론 통합**
- IT/AI 뉴스 브리핑 (12:00) — news-aggregator-skill 활용
- 주간 AI 논문 요약 (일요일 10:00) — arxiv-watcher 활용

**TOOLS.md 업데이트**
- 각 스킬 사용법 정리

---

## 세션 모니터링 크론 수정

- 주기: 10분 → **5분** (`*/5 * * * *`)
- buttons 파라미터 명시적으로 수정 (sonnet이 buffer로 잘못 해석하는 문제)

---

## Compaction 대응 프로토콜 강화

**문제:** compaction 후 정우님이 "하던거 해줘"라고 할 때까지 멍때림
**수정:** AGENTS.md에 자동 복구 프로토콜 추가
- compaction 감지 즉시 memory/context.md + 오늘 날짜 파일 읽기
- 직전 작업 요약 보고
- 바로 이어서 진행 (정우님 지시 기다리지 말 것!)

---

## 교훈

"사이드이펙트 없음" 선언 후 정우님 질문 4개로 4개 버그 발견.
→ 정밀 검토 시 사용자 관점에서 재검토 필수

Compaction 후 멍때리기 금지 — 자동으로 복구하고 이어서 진행해야 함

---

## 크론 × 스킬 전면 연동 ✅

**목표:** 설치된 스킬 27개를 크론에 최대한 활용

**연동된 크론 (12개)**
- 주식 마감 리포트 ← yahoo-finance + stock-analysis (8차원 분석)
- 모닝 브리핑 (사조/관훈) ← yahoo-finance + news-aggregator
- GitHub 활동 체크 ← github (gh CLI)
- 야간 종합 점검 ← process-watch + mole-mac-cleanup + simple-backup
- 일일 자가개선 ← prompt-log + self-improvement
- Idle 자가개선 ← github + clawdhub + clawddocs + gemini
- Daily Auto-Update ← clawdhub + simple-backup 체크
- IT/AI 뉴스 브리핑 ← news-aggregator + summarize
- 주간 AI 논문 요약 ← arxiv-watcher
- 주간 리뷰 ← prompt-log + task-tracker
- SOUL.md 리프레시 ← prompt-log
- 세션 모니터링 ← context-manager (85%+)

**신규 크론**
- Daily Standup (08:30) ← task-tracker

**활용 중인 스킬 (17개)**
yahoo-finance, stock-analysis, github, process-watch, mole-mac-cleanup, simple-backup, prompt-log, self-improvement, news-aggregator, arxiv-watcher, clawdhub, clawddocs, task-tracker, summarize, gemini, context-manager, gog

**온디맨드 스킬 (10개)**
coding-agent, conventional-commits, deepwork-tracker, dexter, portfolio-watcher, youtube-summarizer, obsidian, research, model-usage, session-logs, smart-followups

---

## 리마인더

- **17:45** Warp 전체 디스크 권한 설정 (집 맥북)

---

## 크론 전면 리팩토링 (2차) ✅

**추가 연동된 스킬 (3개)**
- session-logs → 일일 자가개선 + 주간 리뷰 (세션 통계, 도구 사용량 TOP 10)
- context-manager → 야간 종합 점검 (세션 파일 정리/경고)
- github → Daily Auto-Update (CI 체크)

**리팩토링 내용**
- 일일 자가개선: + 세션 통계, + 도구 사용량 TOP 10
- 주간 리뷰: + 주간 메시지 총계, + 주간 도구 TOP 10
- 크론 감시 리포트: + lastDurationMs 체크 (2분 초과 경고), + 자동 수정
- 야간 종합 점검: + 디스크 공간, + pip 캐시, + context-manager 세션 체크
- Daily Auto-Update: + GitHub Actions CI 체크

**신규 크론**
- 크론 감시 리포트 (22:30) — 하루 끝나기 전 크론 상태 점검

**현재 활용 스킬 (21개)**
yahoo-finance, stock-analysis, portfolio-watcher, github, process-watch, mole-mac-cleanup, simple-backup, prompt-log, self-improvement, news-aggregator, arxiv-watcher, clawdhub, clawddocs, task-tracker, summarize, youtube-summarizer, gemini, context-manager, gog, session-logs, ODsay API

**미연동 (설정 필요)**
- blogwatcher — 관심 블로그 URL 추가 필요
- model-usage — CodexBar 설치 필요
- local-places — Google Places API 키 필요

---

## 관훈 로직 구현 ✅

**상태 관리**
- `memory/gwanhun-state.json` — 이번 주 관훈일 상태

**크론 설정**
- "관훈 근무일 확인 (일)" — 매주 일요일 21시, 버튼으로 요일 선택
- "관훈 미확정 저녁 확인" — 평일 19시, 미확정이면 물어봄
- "퇴근 브리핑" — 오늘이 관훈이면 관훈→집 경로, 아니면 사조→집 경로

**플로우**
1. 일요일 저녁 → "이번 주 관훈 언제?"
2. "모르겠어" → 매일 저녁 물어봄
3. 확정 → 그 주는 질문 끝 + 해당일 퇴근은 관훈 경로
4. 2/21 이후에도 동일 (판교+관훈)

---

## 인사말 업그레이드: 시간대 → 상황 기반 (17:47)

**정우님 피드백**
- "17시에 '안녕히 주무세요'는 이상하지 않니?"
- 내 일정을 아니까 상황을 추측해서 인사해야 함

**변경 사항**
- SOUL.md: "시간대별 말투" → "상황 기반 인사"로 전면 개편
- AGENTS.md: "새 세션 시작 시" 인사 로직 변경

**상황 기반 인사 원칙**
- 단순 시간대가 아니라 정우님이 뭐 하고 있을지 추측
- 참고: USER.md 일과, work-state.json, gwanhun-state.json, 요일
- 예: 17시 + 내일 휴가 → "칼퇴하셨겠네요"
- 예: 22시 + 평일 → "내일 출근인데 쉬셔야죠"

---

## 저녁 세션 (17:51~)

### ODsay API URL 인코딩 이슈 해결
- **문제:** API 키에 `+` 문자 포함 → URL에서 공백으로 해석 → 인증 실패
- **해결:** `python3 -c "import urllib.parse; print(urllib.parse.quote('${ODSAY_API_KEY}'))"` 로 인코딩
- **수정한 크론:**
  - 퇴근 브리핑 ✅
  - 모닝 브리핑 (사조) ✅
  - 모닝 브리핑 (관훈) ✅
- TOOLS.md에 사용법 기록함

### 식사 사진 갤러리 구조화
- **위치:** `~/clawd/gallery/meals/`
- **인덱스:** `meals.json` (날짜, 유형, 설명, 태그)
- **파일명 규칙:** `YYYY-MM-DD_type.jpg`
- TOOLS.md에 규칙 기록함

### 교훈 추가 (lessons.md)
- "주말 잘 보내세요. 월요일에 뵙겠습니다" — AI가 할 말 아님 (나는 주말에 안 쉼)
- 시간 계산 실수 반복 (55-54=1인데 "4분 후"라고 함) — 초등학교 산수

---

## 일일 자가개선 (23:00)

**세션 통계**
• 총 메시지: 9개 (user 1, assistant 2, 나머지는 시스템/도구)
• 도구 호출: 3회 (exec 3회)
• 대화 내용: Response Guard 업데이트 + 일일 자가개선 크론 실행

**Response Guard 위반 분석 (오늘 전체)**
• F001 (금지 표현): 4건 — "완료", "알겠습니다" 사용
• F002 (이모지 과다): 12건 — 3개 초과 (최다!)
• F003 (구분선 남발): 3건
• F004 (뻔한 시작): 6건

**패턴**
• 긴 기술 작업 중 페르소나 붕괴 (표 쓰기, 이모지 떡칠, 로봇 말투)
• 10회+ 도구 호출 시 페르소나 점검 안 함 (오늘 25번+ 호출했는데 0회 점검)
• 응답 전 자기검열 생략 → 위반 반복

**교훈 기록**
• `.learnings/ERRORS.md` — 오늘 위반 패턴 분석
• `.learnings/LEARNINGS.md` — 3건 추가
  - Response Guard 내재화 실패
  - ODsay API URL 인코딩 이슈
  - 시간대별 → 상황 기반 인사 개편

**다음 단계**
• 응답 전 체크리스트 템플릿 작성 필요
• 표 사용 완전 금지 — 불릿 포인트만
• 이모지 1개 원칙
